# SPDX-License-Identifier: Apache-2.0
# SPDX-FileCopyrightText: Copyright 2018-2023 Toshiba Corporation and Peraton Labs, Inc.
# See README.md for license details
modbus:
  actions:
  - key: parameters
    type: metasploit
    value:
      action: $action
      data_address: $data_address
      data_registers: $data_registers
      module: auxiliary/scanner/scada/modbusclient
      rhost: $target_host
      unit_number: $unit_number
  capability_class: service
  capability_id: modbus
  cves: ''
  cvss: ''
  postconditions: []
  preconditions:
  - host: $current_host
    key: current_access
    type: state
    value: shell
  - host: $target_host
    key: port
    type: service
    value: tcp/502
  rank: normal
  severity: high
  solution: Restrict access to this sensitive, insecure service.
  subclass: modbus
  title: modbus
modbus.write_register:
  actions:
  - key: parameters
    type: capability
    value:
      action: WRITE_REGISTERS
  capability_class: service
  capability_id: modbus.write_register
  cves: ''
  cvss: ''
  postconditions: []
  preconditions:
  - host: $target_host
    key: capability_id
    type: capability
    value: modbus
  rank: normal
  severity: high
  solution: Restrict access to this sensitive, insecure service.
  subclass: modbus.write_register
  title: modbus.write_register
modbus.write_register.change_temp:
  actions:
  - key: parameters
    type: capability
    value:
      data_address: '2'
      data_registers: '30'
      unit_number: '255'
  capability_class: service
  capability_id: modbus.write_register.change_temp
  cves: ''
  cvss: ''
  postconditions: []
  preconditions:
  - host: $target_host
    key: capability_id
    type: capability
    value: modbus.write_register
  rank: normal
  severity: high
  solution: Restrict access to this sensitive, insecure service.
  subclass: modbus.write_register.change_temp
  title: modbus.write_register.change_temp
privilege_escalation:
  actions: []
  capability_class: template
  capability_id: privilege_escalation
  cves: ''
  cvss: ''
  postconditions:
  - key: current_role
    type: state
    value: admin
  preconditions:
  - host: $target_host
    key: current_access
    type: state
    value: shell
  rank: ''
  severity: high
  solution: Apply product patches.
  subclass: ''
  title: privilege_escalation
rdp:
  actions:
  - key: Remote Desktop
    type: shell_command
    value:
      password: $password
      rhosts: $target_host
      username: $username
  capability_class: service
  capability_id: rdp
  cves: ''
  cvss: ''
  postconditions:
  - key: current_access
    type: state
    value: desktop
  - key: current_host
    type: state
    value: $target_host
  - key: current_role
    type: state
    value: $role
  preconditions:
  - host: $current_host
    key: current_access
    type: state
    value: shell
  - host: $target_host
    key: role
    type: credential
    value: user
  - host: $target_host
    key: port
    type: service
    value: tcp/3389
  rank: normal
  severity: low
  solution: Ensure secure passwords are used.
  subclass: rdp
  title: rdp
remote_code_execution:
  actions: []
  capability_class: template
  capability_id: remote_code_execution
  cves: ''
  cvss: ''
  postconditions:
  - key: current_access
    type: state
    value: metasploit
  - key: current_host
    type: state
    value: $target_host
  - key: current_role
    type: state
    value: admin
  preconditions:
  - host: $target_host
    key: port
    type: service
    value: $protocol/$port
  rank: ''
  severity: high
  solution: Apply product patches.
  subclass: ''
  title: remote_code_execution
smb:
  actions:
  - key: parameters
    type: metasploit
    value:
      module: exploit/windows/smb/psexec
      rhost: $target_host
      smbpass: $password
      smbuser: $username
  capability_class: service
  capability_id: smb
  cves: ''
  cvss: ''
  postconditions:
  - key: current_access
    type: state
    value: metasploit
  - key: current_host
    type: state
    value: $target_host
  - key: current_role
    type: state
    value: $role
  preconditions:
  - host: $current_host
    key: current_access
    type: state
    value: shell
  - host: $target_host
    key: role
    type: credential
    value: user
  - host: $target_host
    key: port
    type: service
    value: tcp/445
  rank: normal
  severity: low
  solution: Ensure this service is properly secured.
  subclass: smb
  title: smb
ssh:
  actions:
  - key: parameters
    type: metasploit
    value:
      module: auxiliary/scanner/ssh/ssh_login
      password: $password
      rhosts: $target_host
      username: $username
  capability_class: service
  capability_id: ssh
  cves: ''
  cvss: ''
  postconditions:
  - key: current_access
    type: state
    value: shell
  - key: current_host
    type: state
    value: $target_host
  - key: current_role
    type: state
    value: $role
  preconditions:
  - host: $current_host
    key: current_access
    type: state
    value: shell
  - host: $target_host
    key: role
    type: credential
    value: user
  - host: $target_host
    key: port
    type: service
    value: tcp/22
  rank: normal
  severity: none
  solution: The password for this service may be compromised.  Change it as soon as
    possible.
  subclass: ssh
  title: ssh
